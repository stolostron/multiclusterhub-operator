apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-2 Baseline Configuration
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-cnv: virt-rbac
  name: policy-virt-clusterroles
  namespace: {{ .Values.global.namespace }}
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-virt-clusterroles
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: aaqs.aaq.kubevirt.io-v1alpha1-admin
            rules:
            - apiGroups:
              - aaq.kubevirt.io
              resources:
              - aaqs
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: aaqs.aaq.kubevirt.io-v1alpha1-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - aaqs.aaq.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: aaqs.aaq.kubevirt.io-v1alpha1-edit
            rules:
            - apiGroups:
              - aaq.kubevirt.io
              resources:
              - aaqs
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: aaqs.aaq.kubevirt.io-v1alpha1-view
            rules:
            - apiGroups:
              - aaq.kubevirt.io
              resources:
              - aaqs
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: bridge-marker-cr
            rules:
            - apiGroups:
              - ""
              resources:
              - nodes
              - nodes/status
              verbs:
              - get
              - update
              - patch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi-apiserver
            rules:
            - apiGroups:
              - authorization.k8s.io
              resources:
              - subjectaccessreviews
              verbs:
              - create
            - apiGroups:
              - ""
              resources:
              - configmaps
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - persistentvolumes
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - storage.k8s.io
              resources:
              - storageclasses
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - namespaces
              verbs:
              - get
            - apiGroups:
              - snapshot.storage.k8s.io
              resources:
              - volumesnapshots
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes
              verbs:
              - list
              - get
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datasources
              verbs:
              - get
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - volumeclonesources
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - storageprofiles
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdis
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdiconfigs
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdis/finalizers
              verbs:
              - update
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi-cronjob
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - dataimportcrons
              verbs:
              - get
              - list
              - update
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi-uploadproxy
            rules:
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi.kubevirt.io:admin
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes
              - dataimportcrons
              - datasources
              - volumeimportsources
              - volumeuploadsources
              - volumeclonesources
              verbs:
              - '*'
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes/source
              verbs:
              - create
            - apiGroups:
              - upload.cdi.kubevirt.io
              resources:
              - uploadtokenrequests
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi.kubevirt.io:config-reader
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdiconfigs
              - storageprofiles
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi.kubevirt.io:edit
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes
              - dataimportcrons
              - datasources
              - volumeimportsources
              - volumeuploadsources
              - volumeclonesources
              verbs:
              - '*'
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes/source
              verbs:
              - create
            - apiGroups:
              - upload.cdi.kubevirt.io
              resources:
              - uploadtokenrequests
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi.kubevirt.io:view
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdiconfigs
              - dataimportcrons
              - datasources
              - datavolumes
              - objecttransfers
              - storageprofiles
              - volumeimportsources
              - volumeuploadsources
              - volumeclonesources
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes/source
              verbs:
              - create
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdi
            rules:
            - apiGroups:
              - ""
              resources:
              - events
              verbs:
              - create
              - patch
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims
              verbs:
              - get
              - list
              - watch
              - create
              - update
              - delete
              - deletecollection
              - patch
            - apiGroups:
              - ""
              resources:
              - persistentvolumes
              verbs:
              - get
              - list
              - watch
              - update
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims/finalizers
              - pods/finalizers
              verbs:
              - update
            - apiGroups:
              - ""
              resources:
              - pods
              - services
              verbs:
              - get
              - list
              - watch
              - create
              - delete
            - apiGroups:
              - ""
              resources:
              - configmaps
              verbs:
              - get
              - create
            - apiGroups:
              - storage.k8s.io
              resources:
              - storageclasses
              - csidrivers
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - config.openshift.io
              resources:
              - proxies
              - infrastructures
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - config.openshift.io
              resources:
              - clusterversions
              verbs:
              - get
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - '*'
              verbs:
              - '*'
            - apiGroups:
              - snapshot.storage.k8s.io
              resources:
              - volumesnapshots
              - volumesnapshotclasses
              - volumesnapshotcontents
              verbs:
              - get
              - list
              - watch
              - create
              - delete
            - apiGroups:
              - snapshot.storage.k8s.io
              resources:
              - volumesnapshots
              verbs:
              - update
              - deletecollection
            - apiGroups:
              - apiextensions.k8s.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - scheduling.k8s.io
              resources:
              - priorityclasses
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - image.openshift.io
              resources:
              - imagestreams
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - secrets
              verbs:
              - create
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines/finalizers
              verbs:
              - update
            - apiGroups:
              - forklift.cdi.kubevirt.io
              resources:
              - ovirtvolumepopulators
              - openstackvolumepopulators
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdis.cdi.kubevirt.io-v1beta1-admin
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdis
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdis.cdi.kubevirt.io-v1beta1-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - cdis.cdi.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdis.cdi.kubevirt.io-v1beta1-edit
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdis
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: cdis.cdi.kubevirt.io-v1beta1-view
            rules:
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - cdis
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hostpathprovisioners.hostpathprovisioner.kubevirt.io-v1beta1-admin
            rules:
            - apiGroups:
              - hostpathprovisioner.kubevirt.io
              resources:
              - hostpathprovisioners
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hostpathprovisioners.hostpathprovisioner.kubevirt.io-v1beta1-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - hostpathprovisioners.hostpathprovisioner.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hostpathprovisioners.hostpathprovisioner.kubevirt.io-v1beta1-edit
            rules:
            - apiGroups:
              - hostpathprovisioner.kubevirt.io
              resources:
              - hostpathprovisioners
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hostpathprovisioners.hostpathprovisioner.kubevirt.io-v1beta1-view
            rules:
            - apiGroups:
              - hostpathprovisioner.kubevirt.io
              resources:
              - hostpathprovisioners
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hyperconvergeds.hco.kubevirt.io-v1beta1-admin
            rules:
            - apiGroups:
              - hco.kubevirt.io
              resources:
              - hyperconvergeds
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hyperconvergeds.hco.kubevirt.io-v1beta1-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - hyperconvergeds.hco.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hyperconvergeds.hco.kubevirt.io-v1beta1-edit
            rules:
            - apiGroups:
              - hco.kubevirt.io
              resources:
              - hyperconvergeds
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: hyperconvergeds.hco.kubevirt.io-v1beta1-view
            rules:
            - apiGroups:
              - hco.kubevirt.io
              resources:
              - hyperconvergeds
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: instancetype.kubevirt.io:view
            rules:
            - apiGroups:
              - instancetype.kubevirt.io
              resources:
              - virtualmachineclusterinstancetypes
              - virtualmachineclusterpreferences
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubemacpool-manager-role
            rules:
            - apiGroups:
              - admissionregistration.k8s.io
              resources:
              - validatingwebhookconfigurations
              verbs:
              - list
              - watch
            - apiGroups:
              - admissionregistration.k8s.io
              resources:
              - mutatingwebhookconfigurations
              verbs:
              - list
              - update
              - watch
            - apiGroups:
              - ""
              resources:
              - secrets
              verbs:
              - list
              - watch
              - create
              - update
            - apiGroups:
              - apiextensions.k8s.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
            - apiGroups:
              - ""
              resources:
              - pods
              verbs:
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - namespaces
              verbs:
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines
              verbs:
              - get
              - list
              - watch
              - update
            - apiGroups:
              - ""
              resources:
              - configmaps
              verbs:
              - get
              - delete
            - apiGroups:
              - authentication.k8s.io
              resources:
              - tokenreviews
              verbs:
              - create
            - apiGroups:
              - authorization.k8s.io
              resources:
              - subjectaccessreviews
              verbs:
              - create
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt-apiserver
            rules:
            - apiGroups:
              - ""
              resources:
              - pods
              verbs:
              - get
              - list
              - delete
              - patch
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines
              - virtualmachineinstances
              verbs:
              - get
              - list
              - watch
              - patch
              - update
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims
              verbs:
              - get
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines/status
              verbs:
              - patch
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachineinstancemigrations
              verbs:
              - create
              - get
              - list
              - watch
              - patch
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachineinstancepresets
              verbs:
              - watch
              - list
            - apiGroups:
              - ""
              resources:
              - configmaps
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - limitranges
              verbs:
              - watch
              - list
            - apiGroups:
              - apiextensions.k8s.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - snapshot.kubevirt.io
              resources:
              - virtualmachinesnapshots
              - virtualmachinerestores
              - virtualmachinesnapshotcontents
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datasources
              - datavolumes
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - namespaces
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - instancetype.kubevirt.io
              resources:
              - virtualmachineinstancetypes
              - virtualmachineclusterinstancetypes
              - virtualmachinepreferences
              - virtualmachineclusterpreferences
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - migrations.kubevirt.io
              resources:
              - migrationpolicies
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - apps
              resources:
              - controllerrevisions
              verbs:
              - create
              - list
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt-controller
            rules:
            - apiGroups:
              - ""
              resources:
              - namespaces
              verbs:
              - get
              - list
              - watch
              - patch
            - apiGroups:
              - policy
              resources:
              - poddisruptionbudgets
              verbs:
              - get
              - list
              - watch
              - delete
              - create
              - patch
            - apiGroups:
              - ""
              resources:
              - pods
              - configmaps
              - endpoints
              - services
              verbs:
              - get
              - list
              - watch
              - delete
              - update
              - create
              - patch
            - apiGroups:
              - ""
              resources:
              - events
              verbs:
              - update
              - create
              - patch
            - apiGroups:
              - ""
              resources:
              - secrets
              verbs:
              - create
            - apiGroups:
              - ""
              resources:
              - pods/finalizers
              verbs:
              - update
            - apiGroups:
              - ""
              resources:
              - pods/eviction
              verbs:
              - create
            - apiGroups:
              - ""
              resources:
              - pods/status
              verbs:
              - patch
            - apiGroups:
              - ""
              resources:
              - nodes
              verbs:
              - get
              - list
              - watch
              - update
              - patch
            - apiGroups:
              - apps
              resources:
              - daemonsets
              verbs:
              - list
            - apiGroups:
              - apps
              resources:
              - controllerrevisions
              verbs:
              - watch
              - list
              - create
              - delete
              - get
              - update
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims
              verbs:
              - get
              - list
              - watch
              - create
              - update
              - delete
              - patch
            - apiGroups:
              - snapshot.kubevirt.io
              resources:
              - virtualmachinesnapshots
              - virtualmachinesnapshots/status
              - virtualmachinesnapshots/finalizers
              - virtualmachinesnapshotcontents
              - virtualmachinesnapshotcontents/status
              - virtualmachinesnapshotcontents/finalizers
              - virtualmachinerestores
              - virtualmachinerestores/status
              verbs:
              - get
              - list
              - watch
              - create
              - update
              - delete
              - patch
            - apiGroups:
              - export.kubevirt.io
              resources:
              - virtualmachineexports
              - virtualmachineexports/status
              - virtualmachineexports/finalizers
              verbs:
              - get
              - list
              - watch
              - create
              - update
              - delete
              - patch
            - apiGroups:
              - pool.kubevirt.io
              resources:
              - virtualmachinepools
              - virtualmachinepools/finalizers
              - virtualmachinepools/status
              - virtualmachinepools/scale
              verbs:
              - watch
              - list
              - create
              - delete
              - update
              - patch
              - get
            - apiGroups:
              - kubevirt.io
              resources:
              - '*'
              verbs:
              - '*'
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines/finalizers
              - virtualmachineinstances/finalizers
              verbs:
              - update
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachineinstances/addvolume
              - virtualmachineinstances/removevolume
              - virtualmachineinstances/freeze
              - virtualmachineinstances/unfreeze
              - virtualmachineinstances/softreboot
              - virtualmachineinstances/sev/setupsession
              - virtualmachineinstances/sev/injectlaunchsecret
              verbs:
              - update
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - '*'
              verbs:
              - '*'
            - apiGroups:
              - k8s.cni.cncf.io
              resources:
              - network-attachment-definitions
              verbs:
              - get
            - apiGroups:
              - apiextensions.k8s.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - authorization.k8s.io
              resources:
              - subjectaccessreviews
              verbs:
              - create
            - apiGroups:
              - snapshot.storage.k8s.io
              resources:
              - volumesnapshotclasses
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - snapshot.storage.k8s.io
              resources:
              - volumesnapshots
              verbs:
              - get
              - list
              - watch
              - create
              - update
              - delete
            - apiGroups:
              - storage.k8s.io
              resources:
              - storageclasses
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - instancetype.kubevirt.io
              resources:
              - virtualmachineinstancetypes
              - virtualmachineclusterinstancetypes
              - virtualmachinepreferences
              - virtualmachineclusterpreferences
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - migrations.kubevirt.io
              resources:
              - migrationpolicies
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - clone.kubevirt.io
              resources:
              - virtualmachineclones
              - virtualmachineclones/status
              - virtualmachineclones/finalizers
              verbs:
              - get
              - list
              - watch
              - update
              - patch
              - delete
            - apiGroups:
              - ""
              resources:
              - namespaces
              verbs:
              - get
            - apiGroups:
              - ""
              resources:
              - resourcequotas
              verbs:
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt-exportproxy
            rules:
            - apiGroups:
              - export.kubevirt.io
              resources:
              - virtualmachineexports
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt-handler
            rules:
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachineinstances
              verbs:
              - update
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - nodes
              verbs:
              - patch
              - list
              - watch
              - get
            - apiGroups:
              - ""
              resources:
              - configmaps
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - ""
              resources:
              - events
              verbs:
              - create
              - patch
            - apiGroups:
              - apiextensions.k8s.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - migrations.kubevirt.io
              resources:
              - migrationpolicies
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt-ipam-controller-manager-role
            rules:
            - apiGroups:
              - ""
              resources:
              - pods
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines
              - virtualmachineinstances
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines/finalizers
              - virtualmachineinstances/finalizers
              verbs:
              - update
            - apiGroups:
              - k8s.cni.cncf.io
              resources:
              - ipamclaims
              - network-attachment-definitions
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - k8s.cni.cncf.io
              resources:
              - ipamclaims
              verbs:
              - create
              - update
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt.io:admin
            rules:
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachineinstances/console
              - virtualmachineinstances/vnc
              - virtualmachineinstances/vnc/screenshot
              - virtualmachineinstances/portforward
              - virtualmachineinstances/guestosinfo
              - virtualmachineinstances/filesystemlist
              - virtualmachineinstances/userlist
              - virtualmachineinstances/sev/fetchcertchain
              - virtualmachineinstances/sev/querylaunchmeasurement
              - virtualmachineinstances/usbredir
              verbs:
              - get
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachineinstances/pause
              - virtualmachineinstances/unpause
              - virtualmachineinstances/addvolume
              - virtualmachineinstances/removevolume
              - virtualmachineinstances/freeze
              - virtualmachineinstances/unfreeze
              - virtualmachineinstances/softreboot
              - virtualmachineinstances/sev/setupsession
              - virtualmachineinstances/sev/injectlaunchsecret
              verbs:
              - update
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachines/expand-spec
              - virtualmachines/portforward
              verbs:
              - get
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachines/start
              - virtualmachines/stop
              - virtualmachines/restart
              - virtualmachines/addvolume
              - virtualmachines/removevolume
              - virtualmachines/migrate
              - virtualmachines/memorydump
              verbs:
              - update
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - expand-vm-spec
              verbs:
              - update
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines
              - virtualmachineinstances
              - virtualmachineinstancepresets
              - virtualmachineinstancereplicasets
              - virtualmachineinstancemigrations
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
              - deletecollection
            - apiGroups:
              - snapshot.kubevirt.io
              resources:
              - virtualmachinesnapshots
              - virtualmachinesnapshotcontents
              - virtualmachinerestores
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
              - deletecollection
            - apiGroups:
              - export.kubevirt.io
              resources:
              - virtualmachineexports
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
              - deletecollection
            - apiGroups:
              - clone.kubevirt.io
              resources:
              - virtualmachineclones
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
              - deletecollection
            - apiGroups:
              - instancetype.kubevirt.io
              resources:
              - virtualmachineinstancetypes
              - virtualmachineclusterinstancetypes
              - virtualmachinepreferences
              - virtualmachineclusterpreferences
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
              - deletecollection
            - apiGroups:
              - pool.kubevirt.io
              resources:
              - virtualmachinepools
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
              - deletecollection
            - apiGroups:
              - migrations.kubevirt.io
              resources:
              - migrationpolicies
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt.io:default
            rules:
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - get
              - list
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - version
              - guestfs
              verbs:
              - get
              - list
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt.io:edit
            rules:
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachineinstances/console
              - virtualmachineinstances/vnc
              - virtualmachineinstances/vnc/screenshot
              - virtualmachineinstances/portforward
              - virtualmachineinstances/guestosinfo
              - virtualmachineinstances/filesystemlist
              - virtualmachineinstances/userlist
              - virtualmachineinstances/sev/fetchcertchain
              - virtualmachineinstances/sev/querylaunchmeasurement
              - virtualmachineinstances/usbredir
              verbs:
              - get
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachineinstances/pause
              - virtualmachineinstances/unpause
              - virtualmachineinstances/addvolume
              - virtualmachineinstances/removevolume
              - virtualmachineinstances/freeze
              - virtualmachineinstances/unfreeze
              - virtualmachineinstances/softreboot
              - virtualmachineinstances/sev/setupsession
              - virtualmachineinstances/sev/injectlaunchsecret
              verbs:
              - update
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachines/expand-spec
              - virtualmachines/portforward
              verbs:
              - get
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachines/start
              - virtualmachines/stop
              - virtualmachines/restart
              - virtualmachines/addvolume
              - virtualmachines/removevolume
              - virtualmachines/migrate
              - virtualmachines/memorydump
              verbs:
              - update
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - expand-vm-spec
              verbs:
              - update
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines
              - virtualmachineinstances
              - virtualmachineinstancepresets
              - virtualmachineinstancereplicasets
              - virtualmachineinstancemigrations
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
            - apiGroups:
              - snapshot.kubevirt.io
              resources:
              - virtualmachinesnapshots
              - virtualmachinesnapshotcontents
              - virtualmachinerestores
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
            - apiGroups:
              - export.kubevirt.io
              resources:
              - virtualmachineexports
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
            - apiGroups:
              - clone.kubevirt.io
              resources:
              - virtualmachineclones
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
            - apiGroups:
              - instancetype.kubevirt.io
              resources:
              - virtualmachineinstancetypes
              - virtualmachineclusterinstancetypes
              - virtualmachinepreferences
              - virtualmachineclusterpreferences
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
            - apiGroups:
              - pool.kubevirt.io
              resources:
              - virtualmachinepools
              verbs:
              - get
              - delete
              - create
              - update
              - patch
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - get
              - list
            - apiGroups:
              - migrations.kubevirt.io
              resources:
              - migrationpolicies
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirt.io:view
            rules:
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - get
              - list
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - virtualmachines/expand-spec
              - virtualmachineinstances/guestosinfo
              - virtualmachineinstances/filesystemlist
              - virtualmachineinstances/userlist
              - virtualmachineinstances/sev/fetchcertchain
              - virtualmachineinstances/sev/querylaunchmeasurement
              verbs:
              - get
            - apiGroups:
              - subresources.kubevirt.io
              resources:
              - expand-vm-spec
              verbs:
              - update
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines
              - virtualmachineinstances
              - virtualmachineinstancepresets
              - virtualmachineinstancereplicasets
              - virtualmachineinstancemigrations
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - snapshot.kubevirt.io
              resources:
              - virtualmachinesnapshots
              - virtualmachinesnapshotcontents
              - virtualmachinerestores
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - export.kubevirt.io
              resources:
              - virtualmachineexports
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - clone.kubevirt.io
              resources:
              - virtualmachineclones
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - instancetype.kubevirt.io
              resources:
              - virtualmachineinstancetypes
              - virtualmachineclusterinstancetypes
              - virtualmachinepreferences
              - virtualmachineclusterpreferences
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - pool.kubevirt.io
              resources:
              - virtualmachinepools
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - migrations.kubevirt.io
              resources:
              - migrationpolicies
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirts.kubevirt.io-v1-admin
            rules:
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirts.kubevirt.io-v1-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - kubevirts.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirts.kubevirt.io-v1-edit
            rules:
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: kubevirts.kubevirt.io-v1-view
            rules:
            - apiGroups:
              - kubevirt.io
              resources:
              - kubevirts
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: networkaddonsconfigs.networkaddonsoperator.network.kubevirt.io-v1-admin
            rules:
            - apiGroups:
              - networkaddonsoperator.network.kubevirt.io
              resources:
              - networkaddonsconfigs
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: networkaddonsconfigs.networkaddonsoperator.network.kubevirt.io-v1-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - networkaddonsconfigs.networkaddonsoperator.network.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: networkaddonsconfigs.networkaddonsoperator.network.kubevirt.io-v1-edit
            rules:
            - apiGroups:
              - networkaddonsoperator.network.kubevirt.io
              resources:
              - networkaddonsconfigs
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: networkaddonsconfigs.networkaddonsoperator.network.kubevirt.io-v1-view
            rules:
            - apiGroups:
              - networkaddonsoperator.network.kubevirt.io
              resources:
              - networkaddonsconfigs
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: os-images.kubevirt.io:edit
            rules:
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims
              verbs:
              - create
              - delete
              - get
              - list
              - patch
              - update
              - watch
            - apiGroups:
              - ""
              resources:
              - persistentvolumeclaims/status
              verbs:
              - get
              - list
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes
              verbs:
              - create
              - delete
              - get
              - list
              - patch
              - update
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datavolumes/source
              verbs:
              - create
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - datasources
              verbs:
              - create
              - delete
              - get
              - list
              - patch
              - update
              - watch
            - apiGroups:
              - cdi.kubevirt.io
              resources:
              - dataimportcrons
              verbs:
              - create
              - delete
              - get
              - list
              - patch
              - update
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: prometheus-k8s-ssp
            rules:
            - apiGroups:
              - ""
              resources:
              - services
              - endpoints
              - pods
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta2-admin
            rules:
            - apiGroups:
              - ssp.kubevirt.io
              resources:
              - ssps
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta2-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - ssps.ssp.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta2-edit
            rules:
            - apiGroups:
              - ssp.kubevirt.io
              resources:
              - ssps
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta2-view
            rules:
            - apiGroups:
              - ssp.kubevirt.io
              resources:
              - ssps
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta3-admin
            rules:
            - apiGroups:
              - ssp.kubevirt.io
              resources:
              - ssps
              verbs:
              - '*'
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta3-crdview
            rules:
            - apiGroups:
              - apiextensions.k8s.io
              resourceNames:
              - ssps.ssp.kubevirt.io
              resources:
              - customresourcedefinitions
              verbs:
              - get
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta3-edit
            rules:
            - apiGroups:
              - ssp.kubevirt.io
              resources:
              - ssps
              verbs:
              - create
              - update
              - patch
              - delete
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: ssps.ssp.kubevirt.io-v1beta3-view
            rules:
            - apiGroups:
              - ssp.kubevirt.io
              resources:
              - ssps
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: ClusterRole
            metadata:
              name: template:view
            rules:
            - apiGroups:
              - template.openshift.io
              resources:
              - templates
              verbs:
              - list
              - watch
            - apiGroups:
              - kubevirt.io
              resources:
              - virtualmachines
              verbs:
              - list
              - watch
        remediationAction: inform
        severity: medium
  remediationAction: inform
